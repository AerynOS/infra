services:
  # Legacy
  caddy:
    image: caddy:2
    ports: 
      - "5000:80"
    volumes:
      - vessel-state:/vessel
      - summit-state:/summit
      - ./legacy/Caddyfile:/etc/caddy/Caddyfile
  summit:
    image: serpentos/summit:legacy
    volumes:
      - summit-state:/app/state
      - ./legacy/summit/.seed:/app/state/.seed
      - ./legacy/summit/seed.json:/app/seed.json
    depends_on:
      vessel:
        condition: service_started
  # vessel:
  #   image: serpentos/vessel:legacy
  #   ports:
  #     - "5001:5001"
  #   volumes:
  #     - vessel-state:/app/state
  #     - ./legacy/vessel/.seed:/app/state/.seed
  #     - ./import:/import
  #   depends_on:
  #     caddy:
  #       condition: service_started
  vessel:
    image: serpentos/vessel
    ports:
      - "5001:5001"
    volumes:
      - vessel-state:/app/state
      - ./vessel/.privkey:/app/state/.privkey
      - ./vessel/config.toml:/app/config.toml
  avalanche:
    image: serpentos/avalanche:legacy
    ports:
      - "5002:5002"
    privileged: true
    volumes:
      - avalanche-state:/app/state
      - ./legacy/avalanche/.seed:/app/state/.seed

volumes:
  summit-state:
  vessel-state:
  avalanche-state:
